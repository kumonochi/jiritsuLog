【概要】
Kintoneでジェノグラムを作成するスクリプトを実装する。

【目的】
Kintone内でジェノグラムの作成を完結することで他サイトや他ツールの使用による手間やコストを軽減するため。

【技術的な要件】
・Kintoneでの利用を想定
・JavaScriptによる実装
・マウス操作のみで完結する直観的な操作が可能なツール
・png形式によるファイル出力機能の実装

【具体的な実装内容】
＜画面構成について＞
・画面の図の情報データはjson形式でフィールドコード「inner_jenogram」（複数文字列）に保存する。
・図はフィールドコード「intake_jenogram」（スペース）に表示する。
・フィールドコード「intake_jenogram」（スペース）をクリックすると専用のポップアップ画面が表示され図の作成・編集ができるようにする。
・フィールドコード「intake_jenogram」（スペース）には作成した図を描写するようにする。
・専用のポップアップ画面の大きさは1200*800で作成する。
・点線でのグリッド線を実装し、図の作成において位置の把握の補助ができるようにする。
・レイアウトはKintoneレイアウトに沿ったシンプルで美しい見た目にする。

＜右クリック動作について＞
・「人物記号の追加」、「関係線の追加」、「居住円」の追加ができるようにする。これらはそれぞれドロップダウンで表示してコンパクトかつ機能的なUIとする。これらはドラッグ＆ドロップで作成箇所を指定し、プレビュー機能により視覚的にどのような記号や線などが追加されるのかわかるようにする。
・「人物記号の追加」では「男性」、「女性」、「性別不明」の記号が追加できるようにする。「男性」の記号は□であり、「女性」の記号は○、「性別不明」の記号は△である。これらはその人物がどのような特徴、状態であるかを表すアイコンである。
・「関係線の追加」では「実線」、「二重線」、「点線」、「波線」、「離婚線」の線が追加できるようにする。これらは人物記号と人物記号との間の関係線を表す線である。なお、結婚線は他の線とは異なり、「//」という記号であり独立している。
・「居住円」では「丸円」、「楕円」、「自由に書く」の円が追加できるようにする。「丸円」、「楕円」は名前の通りの機能である。「自由に書く」では鉛筆機能により自由に線を描写できるようにする。

＜画面に追加された人物記号や関係線の取り扱いについて＞
・人物記号、線はドラッグ&ドロップにより移動ができるようにする。
・人物記号と線、あるいは線と線はスナップ機能により、ぴったりとくっつくようにする。
・人物記号をダブルクリックすると数値の入力をできるようにし、入力された数値は記号の中央に表示するようにする。
・人物記号を右クリックするとメニューを表示し、「対象者に指定」、「死亡者に指定」、「削除」をできるようにする。「対象者に指定」とはマークを二重マークにするということである。たとえば女性であれば◎のようなマークになり、男性であれば□の二重マークになる。「削除」とは名前の通り人物記号の削除である。
・何もないところをドラッグ＆ドロップで範囲選択をできるようにする。

＜pngによる出力について＞
・「画像で出力」というボタンを右下に作成する。
・ボタンを押すと「自動で範囲を選択し出力」、「自分で範囲を選択して出力」のメニューを表示する。「自動で範囲を選択し出力」を選択すると、記号や線、円の配置からすべてが含まれる四角形の範囲を自動で選択しその範囲をpngで出力する。「自分で範囲を選択して出力」を選択すると、ユーザーがドラッグ＆ドロップで出力する範囲を選択しpngで出力する。

以下にジェノグラムの参考図を表示します。作成の参考にしてください。
"C:\Project\kintone\参考図1.png"
"C:\Project\kintone\参考図2.png"
"C:\Project\kintone\参考図3.png"